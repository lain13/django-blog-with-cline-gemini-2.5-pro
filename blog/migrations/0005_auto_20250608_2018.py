# Generated by Django 5.2.2 on 2025-06-08 11:18

from django.db import migrations
from django.conf import settings

def set_default_author(apps, schema_editor):
    """
    기존 Post 데이터에 기본 작성자를 할당합니다.
    기본 User가 없으면 생성하고, 그 User를 할당합니다.
    """
    User = apps.get_model(settings.AUTH_USER_MODEL)
    Post = apps.get_model('blog', 'Post')
    
    # get_or_create를 사용하여 기본 사용자가 없으면 생성합니다.
    default_author, created = User.objects.get_or_create(
        username='default_user', 
        defaults={'password': 'default_password'}
    )

    Post.objects.filter(author__isnull=True).update(author=default_author)

class Migration(migrations.Migration):

    dependencies = [
        ('blog', '0004_post_author'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.RunPython(set_default_author, reverse_code=migrations.RunPython.noop),
    ]
